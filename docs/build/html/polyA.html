
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>polyA package &#8212; PolyA 0.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="polyA" href="modules.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="polya-package">
<h1>polyA package<a class="headerlink" href="#polya-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-polyA.alignment">
<span id="polya-alignment-module"></span><h2>polyA.alignment module<a class="headerlink" href="#module-polyA.alignment" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="polyA.alignment.Alignment">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.alignment.</span></span><span class="sig-name descname"><span class="pre">Alignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subfamily</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_stop</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_stop</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequences</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flank</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_matrix_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_ext</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.alignment.Alignment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>A container to hold data related to a single alignment.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ch&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[],</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">chrom_name</span>
<span class="go">&#39;ch&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">chrom_start</span>
<span class="go">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">chrom_stop</span>
<span class="go">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">chrom_length</span>
<span class="go">76</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.chrom_length">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">chrom_length</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.alignment.Alignment.chrom_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.chrom_name">
<span class="sig-name descname"><span class="pre">chrom_name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#polyA.alignment.Alignment.chrom_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.chrom_start">
<span class="sig-name descname"><span class="pre">chrom_start</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.alignment.Alignment.chrom_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.chrom_stop">
<span class="sig-name descname"><span class="pre">chrom_stop</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.alignment.Alignment.chrom_stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.consensus_start">
<span class="sig-name descname"><span class="pre">consensus_start</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.alignment.Alignment.consensus_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.consensus_stop">
<span class="sig-name descname"><span class="pre">consensus_stop</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.alignment.Alignment.consensus_stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.flank">
<span class="sig-name descname"><span class="pre">flank</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.alignment.Alignment.flank" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 11</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.gap_ext">
<span class="sig-name descname"><span class="pre">gap_ext</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><a class="headerlink" href="#polyA.alignment.Alignment.gap_ext" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 14</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.gap_init">
<span class="sig-name descname"><span class="pre">gap_init</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><a class="headerlink" href="#polyA.alignment.Alignment.gap_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 13</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.score">
<span class="sig-name descname"><span class="pre">score</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.alignment.Alignment.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.sequence">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">sequence</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#polyA.alignment.Alignment.sequence" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.sequences">
<span class="sig-name descname"><span class="pre">sequences</span></span><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.alignment.Alignment.sequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.start">
<span class="sig-name descname"><span class="pre">start</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.alignment.Alignment.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.alignment.Alignment.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.strand">
<span class="sig-name descname"><span class="pre">strand</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#polyA.alignment.Alignment.strand" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 10</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.sub_matrix_name">
<span class="sig-name descname"><span class="pre">sub_matrix_name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#polyA.alignment.Alignment.sub_matrix_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 12</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.subfamily">
<span class="sig-name descname"><span class="pre">subfamily</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#polyA.alignment.Alignment.subfamily" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyA.alignment.Alignment.subfamily_sequence">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">subfamily_sequence</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#polyA.alignment.Alignment.subfamily_sequence" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.alignment.get_skip_state">
<span class="sig-prename descclassname"><span class="pre">polyA.alignment.</span></span><span class="sig-name descname"><span class="pre">get_skip_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#polyA.alignment.get_skip_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the skip state singleton.</p>
</dd></dl>

</section>
<section id="module-polyA.calc_repeat_scores">
<span id="polya-calc-repeat-scores-module"></span><h2>polyA.calc_repeat_scores module<a class="headerlink" href="#module-polyA.calc_repeat_scores" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.calc_repeat_scores.calculate_repeat_scores">
<span class="sig-prename descclassname"><span class="pre">polyA.calc_repeat_scores.</span></span><span class="sig-name descname"><span class="pre">calculate_repeat_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tandem_repeats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#polyA.ultra_provider.TandemRepeat" title="polyA.ultra_provider.TandemRepeat"><span class="pre">polyA.ultra_provider.TandemRepeat</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_all</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_num</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_cells</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_stop</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.calc_repeat_scores.calculate_repeat_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates score (according to ULTRA scoring) for every segment of size
chunksize for all tandem repeats found in the target sequence.
Scores are of the surrounding chunksize nucleotides in the sequence.</p>
<p>At same time, updates AlignMatrix, ActiveCells, and ConsensusMatrix
to include tandem repeat scores.</p>
<p>input:
tandem_repeats: list of tandem repeats from ULTRA output
chunk_size: size of nucleotide chunks that are scored
start_all: minimum starting nucleotide position
row_num: number of rows in matrices
columns: all columns that are not empty from alignment scores
active_cells: dictionary that maps column number to a list of active rows
align_matrix
consensus_matrix: dictionary that maps a tuple (row, col) to consensus
position in the subfam/query sequence
shard_start: start seq pos of current shard
shard_stop: stop seq pos of current shard</p>
<p>output:
repeat_scores: Hash implementation of sparse 1d array. Key is int that maps col
index in the target sequence to it’s tandem repeat score. Used in FillNodeConfidence.</p>
<p>tr_info - list of dictionaries - [{‘Start’: num, ‘Length’: num, ‘PositionScoreDelta’: ‘-0.014500:1.27896’}, …]
&gt;&gt;&gt; repeats = [TandemRepeat.from_json(m) for m in [{‘Start’: 5, ‘Length’: 4, ‘PositionScoreDelta’: ‘-0.5:1:1.5:1’, ‘Consensus’: ‘AT’}, {‘Start’: 10, ‘Length’: 8, ‘PositionScoreDelta’: ‘0:0.5:0.5:1.5:1.5:1:0.5:-0.5’, ‘Consensus’: ‘GTT’}]]
&gt;&gt;&gt; align_mat = {}
&gt;&gt;&gt; active_cols = {}
&gt;&gt;&gt; rep_scores = calculate_repeat_scores(repeats, 5, 4, 1, active_cols, align_mat, {}, 1, 30)
&gt;&gt;&gt; rep_scores
{2: -0.5, 3: 1.0, 4: 1.5, 5: 1.0, 7: 0.0, 8: 0.5, 9: 0.5, 10: 1.5, 11: 1.5, 12: 1.0, 13: 0.5, 14: -0.5}
&gt;&gt;&gt; align_mat
{(1, 2): 3.3333333333333335, (1, 3): 3.75, (1, 4): 3.75, (1, 5): 5.833333333333333, (2, 7): 1.6666666666666667, (2, 8): 3.125, (2, 9): 4.0, (2, 10): 5.0, (2, 11): 5.0, (2, 12): 4.0, (2, 13): 3.125, (2, 14): 1.6666666666666667}
&gt;&gt;&gt; active_cols
{2: [0, 1], 3: [0, 1], 4: [0, 1], 5: [0, 1], 7: [0, 2], 8: [0, 2], 9: [0, 2], 10: [0, 2], 11: [0, 2], 12: [0, 2], 13: [0, 2], 14: [0, 2]}</p>
<p>Shard cuts off TR from left side
&gt;&gt;&gt; repeats = [TandemRepeat.from_json(m) for m in [{‘Start’: 5, ‘Length’: 4, ‘PositionScoreDelta’: ‘-0.5:1:1.5:1’, ‘Consensus’: ‘AT’}, {‘Start’: 10, ‘Length’: 8, ‘PositionScoreDelta’: ‘0:0.5:0.5:1.5:1.5:1:0.5:-0.5’, ‘Consensus’: ‘GTT’}]]
&gt;&gt;&gt; align_mat = {}
&gt;&gt;&gt; active_cols = {}
&gt;&gt;&gt; rep_scores = calculate_repeat_scores(repeats, 5, 4, 1, active_cols, align_mat, {}, 6, 30)
&gt;&gt;&gt; rep_scores
{3: 1.0, 4: 1.5, 5: 1.0, 7: 0.0, 8: 0.5, 9: 0.5, 10: 1.5, 11: 1.5, 12: 1.0, 13: 0.5, 14: -0.5}
&gt;&gt;&gt; align_mat
{(1, 3): 3.75, (1, 4): 3.75, (1, 5): 5.833333333333333, (2, 7): 1.6666666666666667, (2, 8): 3.125, (2, 9): 4.0, (2, 10): 5.0, (2, 11): 5.0, (2, 12): 4.0, (2, 13): 3.125, (2, 14): 1.6666666666666667}
&gt;&gt;&gt; active_cols
{3: [0, 1], 4: [0, 1], 5: [0, 1], 7: [0, 2], 8: [0, 2], 9: [0, 2], 10: [0, 2], 11: [0, 2], 12: [0, 2], 13: [0, 2], 14: [0, 2]}</p>
<p>Shard cuts off TR from right side in first half of chunk
&gt;&gt;&gt; repeats = [TandemRepeat.from_json(m) for m in [{‘Start’: 5, ‘Length’: 4, ‘PositionScoreDelta’: ‘-0.5:1:1.5:1’, ‘Consensus’: ‘AT’}, {‘Start’: 10, ‘Length’: 8, ‘PositionScoreDelta’: ‘0:0.5:0.5:1.5:1.5:1:0.5:-0.5’, ‘Consensus’: ‘GTT’}]]
&gt;&gt;&gt; align_mat = {}
&gt;&gt;&gt; active_cols = {}
&gt;&gt;&gt; rep_scores = calculate_repeat_scores(repeats, 5, 4, 1, active_cols, align_mat, {}, 1, 11)
&gt;&gt;&gt; rep_scores
{2: -0.5, 3: 1.0, 4: 1.5, 5: 1.0, 7: 0.0, 8: 0.5}
&gt;&gt;&gt; align_mat
{(1, 2): 3.3333333333333335, (1, 3): 3.75, (1, 4): 3.75, (1, 5): 5.833333333333333, (2, 7): 1.6666666666666667, (2, 8): 3.125}
&gt;&gt;&gt; active_cols
{2: [0, 1], 3: [0, 1], 4: [0, 1], 5: [0, 1], 7: [0, 2], 8: [0, 2]}</p>
</dd></dl>

</section>
<section id="module-polyA.calculate_score">
<span id="polya-calculate-score-module"></span><h2>polyA.calculate_score module<a class="headerlink" href="#module-polyA.calculate_score" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.calculate_score.calc_target_char_counts">
<span class="sig-prename descclassname"><span class="pre">polyA.calculate_score.</span></span><span class="sig-name descname"><span class="pre">calc_target_char_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_seq</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_chars</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.calculate_score.calc_target_char_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the char counts in the target sequence which will be used in the calculation
to determine a character’s contribution to the complexity adjusted score.</p>
<p>input:
query_seq: query sequence from alignment
target_seq: target sequence from alignment
target_chars: chars in the target sequence that will contribute to
the complexity adjusted score</p>
<p>output:
target_char_counts: dictionary of the target chars to their count
in the target sequence that will contribute to the adjusted score
other_chars: other chars found in the target sequence that do not contribute
to the complexity adjustment (gaps, padding)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.calculate_score.calculate_complexity_adjusted_score">
<span class="sig-prename descclassname"><span class="pre">polyA.calculate_score.</span></span><span class="sig-name descname"><span class="pre">calculate_complexity_adjusted_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char_background_freqs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_seq</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.calculate_score.calculate_complexity_adjusted_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the per position contribution to the complexity adjusted score
of the alignment for each valid char in the target sequence.
This calculation is from the cross_match complexity adjustment functions:</p>
<div class="math notranslate nohighlight">
\[t_{i} = \text{count of $i^{th}$ character}\]</div>
<div class="math notranslate nohighlight">
\[p_{i} = \text{background frequency of $i^{th}$ character}\]</div>
<div class="math notranslate nohighlight">
\[t_{factor} = \sum_{i=0}^{N} t_{i}ln(t_{i}) - \left[ \left( \sum_{i=0}^{N} t_{i} \right) ln(\sum_{i=0}^{N} t_{i}) \right]\]</div>
<div class="math notranslate nohighlight">
\[t_{sum} = \left[ \sum_{i=0}^{N} t_{i} ln(p_{i}) \right] - t_{factor}\]</div>
<div class="math notranslate nohighlight">
\[s_{adj} = s_{raw} + (\frac{t_{sum}}{\lambda}) + 0.999\]</div>
<p>input:
char_background_freqs: background frequencies of the chars from the scoring matrix
query_seq: query sequence from alignment
target_seq: target sequence from alignment
lamb: lambda value used from the scoring matrix</p>
<p>output:
char_complexity_adjustments: a char’s per position contribution to the
complexity adjusted score</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;TCAGACTGTTCA-----ACTCACCTGGCAGCCACTTCCAGA&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="s2">&quot;TCAGACTGTTCATGAGTGCTCACCTGGTAGAGG-----AAA&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lamb</span> <span class="o">=</span> <span class="mf">0.1227</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_complexity_adjusted_score</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">lamb</span><span class="p">)</span>
<span class="go">{&#39;T&#39;: 0.0, &#39;C&#39;: 0.0, &#39;A&#39;: 0.0, &#39;G&#39;: 0.0, &#39;-&#39;: 0.0}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">char_freqs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">0.295</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mf">0.205</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.205</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mf">0.295</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_complexity_adjusted_score</span><span class="p">(</span><span class="n">char_freqs</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">lamb</span><span class="p">)</span>
<span class="go">{&#39;A&#39;: -0.08342236356495786, &#39;G&#39;: -0.11790190327726593, &#39;C&#39;: -0.11790190327726593, &#39;T&#39;: -0.08342236356495786, &#39;-&#39;: 0.0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.calculate_score.calculate_score">
<span class="sig-prename descclassname"><span class="pre">polyA.calculate_score.</span></span><span class="sig-name descname"><span class="pre">calculate_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gap_ext</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_char_seq1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_char_seq2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char_complexity_adjustment</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="headerlink" href="#polyA.calculate_score.calculate_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the score for an alignment between a subfamily and a target/chromsome sequence.
Scores are calculated based on input sub_matrix, gap_ext, and gap_init.</p>
<p>prev_char_seq1, prev_char_seq2 are the single nucleotides in the alignment before the chunk - if
chunk starts with ‘-’ these tell us to use gap_init or gap_ext as the penalty</p>
<p>input:
gap_ext: penalty to extend a gap
gap_init: penalty to start a gap
seq1: sequence chunk from alignment
seq2: sequence chunk from alignment
prev_char_seq1: character before alignment - tells if should use gap_ext or gap_init
prev_char_seq2: character before alignment - tells if should use gap_ext or gap_init
sub_matrix: input substitution matrix - dict that maps 2 chars being aligned to the score</p>
<p>output:
alignment score</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_mat</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;AA&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;TA&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;TT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">char_adjustments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_score</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">sub_mat</span><span class="p">,</span> <span class="n">char_adjustments</span><span class="p">)</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_score</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">sub_mat</span><span class="p">,</span> <span class="n">char_adjustments</span><span class="p">)</span>
<span class="go">-24.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_score</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">sub_mat</span><span class="p">,</span> <span class="n">char_adjustments</span><span class="p">)</span>
<span class="go">-4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">char_adjustments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_score</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">sub_mat</span><span class="p">,</span> <span class="n">char_adjustments</span><span class="p">)</span>
<span class="go">-24.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_score</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">sub_mat</span><span class="p">,</span> <span class="n">char_adjustments</span><span class="p">)</span>
<span class="go">-4.4</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.collapse_matrices">
<span id="polya-collapse-matrices-module"></span><h2>polyA.collapse_matrices module<a class="headerlink" href="#module-polyA.collapse_matrices" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.collapse_matrices.collapse_matrices">
<span class="sig-prename descclassname"><span class="pre">polyA.collapse_matrices.</span></span><span class="sig-name descname"><span class="pre">collapse_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row_count</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_all</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strands</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stops</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_cells</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">support_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#polyA.matrices.CollapsedMatrices" title="polyA.matrices.CollapsedMatrices"><span class="pre">polyA.matrices.CollapsedMatrices</span></a><a class="headerlink" href="#polyA.collapse_matrices.collapse_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>In all preceding matrices, collapse and combine rows that are the same subfam.</p>
<p>input:
row_num: number of rows in matrices
columns: list of non empty cols in matrices
subfams: subfamily names for rows in matrices - each row is a different alignment
strands: which strand each alignment is on
active_cells: maps column number with rows that are active in that column
support_matrix: uncollapsed support matrix - rows are number indices
consensus_matrix: uncollapsed consensus matrix - rows are number indices</p>
<p>output:
CollapsedMatrices container</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">non_cols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">active</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">,</span> <span class="s2">&quot;s3&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strandss</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sup_mat</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mf">.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mf">.2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mf">0.9</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con_mat</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">10</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">con_mat_col</span><span class="p">,</span> <span class="n">strand_mat_col</span><span class="p">,</span> <span class="n">sup_mat_col</span><span class="p">,</span> <span class="n">sub_col</span><span class="p">,</span> <span class="n">active_col</span><span class="p">,</span> <span class="n">sub_col_ind</span><span class="p">,</span> <span class="n">sub_aligns</span><span class="p">)</span> <span class="o">=</span> <span class="n">collapse_matrices</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">non_cols</span><span class="p">,</span> <span class="n">subs</span><span class="p">,</span> <span class="n">strandss</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">active</span><span class="p">,</span> <span class="n">sup_mat</span><span class="p">,</span> <span class="n">con_mat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con_mat_col</span>
<span class="go">{(0, 1): 0, (1, 1): 0, (2, 1): 0, (0, 2): 1, (1, 2): 1, (2, 2): 3, (0, 3): 2, (1, 3): 2, (2, 3): 10}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strand_mat_col</span>
<span class="go">{(0, 1): &#39;+&#39;, (1, 1): &#39;-&#39;, (2, 1): &#39;-&#39;, (0, 2): &#39;+&#39;, (1, 2): &#39;-&#39;, (2, 2): &#39;-&#39;, (0, 3): &#39;+&#39;, (1, 3): &#39;-&#39;, (2, 3): &#39;-&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sup_mat_col</span>
<span class="go">{(0, 1): 0.5, (1, 1): 0.2, (2, 1): 0.1, (0, 2): 0.5, (1, 2): 0.2, (2, 2): 0.1, (0, 3): 0.1, (1, 3): 0.2, (2, 3): 0.9}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_col</span>
<span class="go">[&#39;s1&#39;, &#39;s2&#39;, &#39;s3&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">active_col</span>
<span class="go">{1: [0, 1, 2], 2: [0, 1, 2], 3: [0, 1, 2]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_col_ind</span>
<span class="go">{&#39;s1&#39;: 0, &#39;s2&#39;: 1, &#39;s3&#39;: 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_aligns</span>
<span class="go">{(&#39;s1&#39;, 1): (0, 0), (&#39;s2&#39;, 1): (1, 0), (&#39;s3&#39;, 1): (2, 0), (&#39;s1&#39;, 2): (0, 1), (&#39;s2&#39;, 2): (1, 1), (&#39;s3&#39;, 2): (2, 3), (&#39;s1&#39;, 3): (0, 2), (&#39;s2&#39;, 3): (1, 2), (&#39;s3&#39;, 3): (2, 10)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.collapse_matrices.dp_for_collapse">
<span class="sig-prename descclassname"><span class="pre">polyA.collapse_matrices.</span></span><span class="sig-name descname"><span class="pre">dp_for_collapse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dp_rows</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">support_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_empty</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.collapse_matrices.dp_for_collapse" title="Permalink to this definition">¶</a></dt>
<dd><p>When there is more than one row with the same subfam label, do a mini DP trace
to choose which row to use in collapsed matrices</p>
<p>input:
dp_rows: rows in original matrices to be collapsed
support_matrix: uncollapsed support matrix, use these score for dp
columns: list of non empty cols in matrices</p>
<p>output:
path: list with labels for which row to collapse to for each column
non_empty: list of non empty cols for this particular subfam (in the mini dp matrix)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dp_r</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">act</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">non_cols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sup_mat</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mf">.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mf">0.9</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">dp_for_collapse</span><span class="p">(</span><span class="n">dp_r</span><span class="p">,</span> <span class="n">act</span><span class="p">,</span> <span class="n">sup_mat</span><span class="p">,</span> <span class="n">non_cols</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">[2, 2, 2]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.confidence_cm">
<span id="polya-confidence-cm-module"></span><h2>polyA.confidence_cm module<a class="headerlink" href="#module-polyA.confidence_cm" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.confidence_cm.confidence_cm">
<span class="sig-prename descclassname"><span class="pre">polyA.confidence_cm.</span></span><span class="sig-name descname"><span class="pre">confidence_cm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfam_counts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfam_rows</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_confidence_bool</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.confidence_cm.confidence_cm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes confidence values for competing annotations using alignment and tandem
repeat scores. Loops through the array once to find sum of 2^every_hit_score in
region, then loops back through to calculate confidence. Converts the alignment
score to account for lambda before summing.</p>
<p>If command line option for subfam_counts, this is included in confidence math.</p>
<p>input:
infile: test if subfam_counts infile included at command line
region: list of scores for competing annotations
subfam_counts: dict that maps subfam name to it’s count info
subfams: list of subfam names
subfam_rows: list of subfamily rows that correspond to the the subfams of the region scores
repeats: number of tandem repeat scores found at the end of the region
node_confidence_bool: if False (0) - confidence for filling DP matrices, if True - confidence for nodes</p>
<p>output:
confidence_list: list of confidence values for competing annotations, each input alignment
and tandem repeat score will have one output confidence score</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;s1&quot;</span><span class="p">:</span> <span class="mf">.33</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">:</span> <span class="mf">.33</span><span class="p">,</span> <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="mf">.33</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">,</span> <span class="s2">&quot;s3&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">confidence_cm</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">counts</span><span class="p">,</span> <span class="n">subs</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.50&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.25&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.25&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">confidence_cm</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">subs</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.01&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">confidence_cm</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">subs</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.00&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;s1&quot;</span><span class="p">:</span> <span class="mf">.31</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">:</span> <span class="mf">.31</span><span class="p">,</span> <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="mf">.31</span><span class="p">,</span> <span class="s2">&quot;Tandem Repeat&quot;</span><span class="p">:</span> <span class="mf">.06</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">,</span> <span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="s2">&quot;Tandem Repeat&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">confidence_cm</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="n">counts</span><span class="p">,</span> <span class="n">subs</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.65&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.32&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.03&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.confidence_cm.confidence_only">
<span class="sig-prename descclassname"><span class="pre">polyA.confidence_cm.</span></span><span class="sig-name descname"><span class="pre">confidence_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.confidence_cm.confidence_only" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes confidence values for competing annotations using alignment scores. Loops
through the array once to find sum of 2^every_hit_score in
region, then loops back through to calculate confidence. Converts the alignment
score to account for lambda before summing.</p>
<p>input:
lambdaa: lambda for score matrix used
region: list of scores for competing annotations
subfams: list of subfam names</p>
<p>output:
confidence_list: list of confidence values for competing annotations</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.1227</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">confidence_only</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">lambs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span>
<span class="go">[0.9843787551069454, 0.015380918048546022, 0.0002403268445085316]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.constants">
<span id="polya-constants-module"></span><h2>polyA.constants module<a class="headerlink" href="#module-polyA.constants" title="Permalink to this headline">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.CHANGE_PROB">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">CHANGE_PROB</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1e-55</span></em><a class="headerlink" href="#polyA.constants.CHANGE_PROB" title="Permalink to this definition">¶</a></dt>
<dd><p>The base probability of changing annotations.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.CROSS_MATCH_ADJUSTMENT">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">CROSS_MATCH_ADJUSTMENT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.999</span></em><a class="headerlink" href="#polyA.constants.CROSS_MATCH_ADJUSTMENT" title="Permalink to this definition">¶</a></dt>
<dd><p>A constant value given from cross_match that is used to compute
the complexity adjusted score of an alignment.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.DEFAULT_CHUNK_SIZE">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_CHUNK_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">31</span></em><a class="headerlink" href="#polyA.constants.DEFAULT_CHUNK_SIZE" title="Permalink to this definition">¶</a></dt>
<dd><p>The width of the “window” used to break a sequence up into segments.
Measured in base pairs.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.DEFAULT_SHARD_GAP">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_SHARD_GAP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">-1</span></em><a class="headerlink" href="#polyA.constants.DEFAULT_SHARD_GAP" title="Permalink to this definition">¶</a></dt>
<dd><p>Allowed gap between sequences for them to be included in the same shard.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.INFINITE_SHARD_GAP">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">INFINITE_SHARD_GAP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">-1</span></em><a class="headerlink" href="#polyA.constants.INFINITE_SHARD_GAP" title="Permalink to this definition">¶</a></dt>
<dd><p>A magic value that indicates no sharding should occur.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.NAN_STRING">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">NAN_STRING</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'NaN'</span></em><a class="headerlink" href="#polyA.constants.NAN_STRING" title="Permalink to this definition">¶</a></dt>
<dd><p>The string used to represent “not a number” for serialization and
deserialization.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.PROB_SKIP">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">PROB_SKIP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.4</span></em><a class="headerlink" href="#polyA.constants.PROB_SKIP" title="Permalink to this definition">¶</a></dt>
<dd><p>used for prior counts, about 60% of genome is TE derived, so the skip
state will have a prob of 40%</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.PROB_SKIP_TR">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">PROB_SKIP_TR</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.06</span></em><a class="headerlink" href="#polyA.constants.PROB_SKIP_TR" title="Permalink to this definition">¶</a></dt>
<dd><p>About 6% of the genome is expected to be tandem repeats.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.SAME_PROB_LOG">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">SAME_PROB_LOG</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.0</span></em><a class="headerlink" href="#polyA.constants.SAME_PROB_LOG" title="Permalink to this definition">¶</a></dt>
<dd><p>penalty for staying int he same state in the DP.
mathematically not exactly 0, but in python log(1-10e-45) = 0
so set to 0 and avoid doing the math</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.SKIP_ALIGN_SCORE">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">SKIP_ALIGN_SCORE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">10.0</span></em><a class="headerlink" href="#polyA.constants.SKIP_ALIGN_SCORE" title="Permalink to this definition">¶</a></dt>
<dd><p>alignment score given to skip state, no lambda adjustment needed</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.constants.START_ID">
<span class="sig-prename descclassname"><span class="pre">polyA.constants.</span></span><span class="sig-name descname"><span class="pre">START_ID</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1111</span></em><a class="headerlink" href="#polyA.constants.START_ID" title="Permalink to this definition">¶</a></dt>
<dd><p>The arbitrary temporary ID used to bootstrap the graph process. The
value doesn’t matter, but it’s here for clarity.</p>
</dd></dl>

</section>
<section id="module-polyA.edges">
<span id="polya-edges-module"></span><h2>polyA.edges module<a class="headerlink" href="#module-polyA.edges" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.edges.edges">
<span class="sig-prename descclassname"><span class="pre">polyA.edges.</span></span><span class="sig-name descname"><span class="pre">edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stops</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.edges.edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Find and return the min start and max stop positions for the entire region
included in the alignments.</p>
<p>Inputs:</p>
<p>starts - start positions on the target sequence from the input alignment
stops - stop positions on the target sequence from the input alignment</p>
<p>Outputs:</p>
<p>minimum and maximum start and stop positions on the chromosome/target
sequences for whole alignment</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">edges</span><span class="p">(</span><span class="n">starts</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">stops</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.extract_nodes">
<span id="polya-extract-nodes-module"></span><h2>polyA.extract_nodes module<a class="headerlink" href="#module-polyA.extract_nodes" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.extract_nodes.extract_nodes">
<span class="sig-prename descclassname"><span class="pre">polyA.extract_nodes.</span></span><span class="sig-name descname"><span class="pre">extract_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">changes_position</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_graph</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#polyA.extract_nodes.extract_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>finds nodes that only have one (or less) incoming and one (or less) outgoing edge and adds
them to remove_starts and remove_stops so they can be extracted from the alignment - all columns
in removed nodes are removed from NonEmptyColumns (columns) so during next round of DP calculations,
those nodes are ignored and surrounding nodes can be stitched if necessary,</p>
<p>input:
num_col: number of columns in matrices
nodes: number of nodes in graph
columns: non empty columns in matrices
changes_position: node boundaries
path_graph: 2D array that represents edges in the graph</p>
<p>output:
updated_num_col: updated number of columns after nodes are extracted</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">non_cols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_graph</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extract_nodes</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">non_cols</span><span class="p">,</span> <span class="n">change_pos</span><span class="p">,</span> <span class="n">path_graph</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">non_cols</span>
<span class="go">[0, 1, 2, 7, 8, 9]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.fill_align_matrix">
<span id="polya-fill-align-matrix-module"></span><h2>polyA.fill_align_matrix module<a class="headerlink" href="#module-polyA.fill_align_matrix" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.fill_align_matrix.fill_align_matrix">
<span class="sig-prename descclassname"><span class="pre">polyA.fill_align_matrix.</span></span><span class="sig-name descname"><span class="pre">fill_align_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_count</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_inits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_exts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_align_score</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chroms</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stops</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_matrices</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_freqs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.fill_align_matrix.fill_align_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills an alignment score matrix by calculating an alignment score (according
to crossmatch scoring) for every segment of size <cite>chunk_size</cite> for all
sequences.</p>
<p>Scores are based on the surrounding <cite>chunk_size</cite> nucleotides in the
alignment. Ex: column 15 in the matrix holds the aligment score for
nucleotides at positons 0 - 30, assuming <cite>chunk_size</cite> = 31.</p>
<p>Starting and trailing cells are treated differently. For example, column 0
in the matrix holds the alignment score for nucleotides 0 - 15, column 1
represents nucleotides 0 - 16, etc. Scores are weighted based on number of
nucleotides that contribute to the score.</p>
<p>This algorithm ignores all padded indices (“.”) in the chroms and subfams
lists.</p>
<p>Speed up by computing base score for the first segment, moves to next column
but adding next chars score to base score and subtracting previous chars
score from base score. Restarts and recomputes new base score when
necessary.</p>
<p>Inputs:</p>
<p>everything needed for CalcScore()
edge_start: where alignment starts on the target/chrom sequence
chunk_size: size of nucletide chunks that are scored
skip_align_score: alignment score to give the skip state (default = 0)
subfams: alignments to calculate scores from
chroms: alignments to calculate scores from
starts: where in the target sequence the competing alignments start</p>
<p>Outputs:</p>
<p>align_matrix: Hash implementation of sparse 2D matrix used in pre-DP calculations.
Key is tuple[int, int] that maps row, col to the value held in that cell of matrix. Rows
are  subfamilies in the input alignment file, cols are nucleotide positions in the target sequence.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chros</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAT...............&quot;</span><span class="p">,</span> <span class="s2">&quot;TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAT...............&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...............&quot;</span><span class="p">,</span> <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA--A...............&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">39</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_mat</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;AA&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;TA&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;TT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">}]</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">back_freqs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">fill_align_matrix</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">subs</span><span class="p">,</span> <span class="n">chros</span><span class="p">,</span> <span class="n">strts</span><span class="p">,</span> <span class="n">stps</span><span class="p">,</span> <span class="n">sub_mat</span><span class="p">,</span> <span class="n">back_freqs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span>
<span class="go">{(1, 3): 3.1, (1, 4): 3.1, (1, 5): 3.1, (1, 6): 3.1, (1, 7): 3.1, (1, 8): 3.1, (1, 9): 3.1, (1, 10): 3.1, (1, 11): 3.1, (1, 12): 3.1, (1, 13): 3.1, (1, 14): 3.1, (1, 15): 3.1, (1, 16): 3.1, (1, 17): 3.1, (1, 18): 3.1, (1, 19): 3.1, (1, 20): 3.1, (1, 21): 3.1, (1, 22): 3.1, (1, 23): 3.1, (1, 24): 3.1, (1, 25): 2.9000000000000004, (1, 26): 2.8933333333333335, (1, 27): 2.8862068965517245, (1, 28): 2.878571428571429, (1, 29): 2.8703703703703702, (1, 30): 2.861538461538462, (1, 31): 2.8520000000000003, (1, 32): 2.841666666666667, (1, 33): 2.8304347826086955, (1, 34): 2.8181818181818183, (1, 35): 2.804761904761905, (1, 36): 2.7900000000000005, (1, 37): 2.7736842105263158, (1, 38): 2.7555555555555555, (1, 39): 2.735294117647059, (1, 40): 2.7125000000000004, (2, 1): 2.7125000000000004, (2, 2): 2.735294117647059, (2, 3): 2.755555555555556, (2, 4): 2.7736842105263158, (2, 5): 2.79, (2, 6): 2.804761904761905, (2, 7): 2.8181818181818183, (2, 8): 2.830434782608696, (2, 9): 2.841666666666667, (2, 10): 2.8520000000000003, (2, 11): 2.861538461538462, (2, 12): 2.8703703703703702, (2, 13): 2.8785714285714286, (2, 14): 2.8862068965517245, (2, 15): 2.8933333333333335, (2, 16): 2.9000000000000004, (2, 17): 3.1, (2, 18): 3.1, (2, 19): 3.1, (2, 20): 3.1, (2, 21): 3.1, (2, 22): 3.1, (2, 23): 0.5, (2, 24): -0.1, (2, 25): -0.30000000000000004, (2, 26): -0.41333333333333333, (2, 27): -0.5344827586206897, (2, 28): -0.6642857142857143, (2, 29): -0.8037037037037037, (2, 30): -0.9538461538461539, (2, 31): -1.116, (2, 32): -1.291666666666667, (2, 33): -1.482608695652174, (2, 34): -1.6909090909090907, (2, 35): -1.9190476190476191, (2, 36): -2.17, (2, 37): -2.447368421052632, (2, 38): -2.7555555555555555, (2, 39): -3.1, (2, 40): -3.4875000000000003, (0, 0): 1.0, (0, 1): 1.0, (0, 2): 1.0, (0, 3): 1.0, (0, 4): 1.0, (0, 5): 1.0, (0, 6): 1.0, (0, 7): 1.0, (0, 8): 1.0, (0, 9): 1.0, (0, 10): 1.0, (0, 11): 1.0, (0, 12): 1.0, (0, 13): 1.0, (0, 14): 1.0, (0, 15): 1.0, (0, 16): 1.0, (0, 17): 1.0, (0, 18): 1.0, (0, 19): 1.0, (0, 20): 1.0, (0, 21): 1.0, (0, 22): 1.0, (0, 23): 1.0, (0, 24): 1.0, (0, 25): 1.0, (0, 26): 1.0, (0, 27): 1.0, (0, 28): 1.0, (0, 29): 1.0, (0, 30): 1.0, (0, 31): 1.0, (0, 32): 1.0, (0, 33): 1.0, (0, 34): 1.0, (0, 35): 1.0, (0, 36): 1.0, (0, 37): 1.0, (0, 38): 1.0, (0, 39): 1.0, (0, 40): 1.0}</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.fill_confidence_matrix">
<span id="polya-fill-confidence-matrix-module"></span><h2>polyA.fill_confidence_matrix module<a class="headerlink" href="#module-polyA.fill_confidence_matrix" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.fill_confidence_matrix.fill_confidence_matrix">
<span class="sig-prename descclassname"><span class="pre">polyA.fill_confidence_matrix.</span></span><span class="sig-name descname"><span class="pre">fill_confidence_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_count</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfam_counts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_cells</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.fill_confidence_matrix.fill_confidence_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills confidence matrix from alignment matrix. Each column in the alignment
matrix is a group of competing annotations that are input into
confidence_cm, the output confidence values are used to populate
confidence_matrix.</p>
<p>Inputs:</p>
<p>columns - non empty matrix column indices
subfam_counts - mapping of subfamily names to their prior counts
subfams - list of subfamily names taken from the original alignments
active_cells - map of column indices (from columns) into list of non-empty
rows for the given column
align_matrix - the alignment matrix from fill_align_matrix</p>
<p>Outputs:</p>
<p>confidence_matrix - hash implementation of sparse 2D matrix used in pre-DP
calculations. Key is tuple[int, int] that maps row, col with the value held
in that cell of matrix. Rows are subfamilies in the input alignment file,
cols are nucleotide positions in the alignment. Each cell in matrix is the
confidence score calculated from all the alignment scores in a column of the
alignment matrix.</p>
<p>TODO: Update test to reflect that real matrices have only skip state in first and last columns</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">align_mat</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">99</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">100</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">active</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col_count</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;s1&quot;</span><span class="p">:</span> <span class="mf">.33</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">:</span> <span class="mf">.33</span><span class="p">,</span> <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="mf">.33</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf_mat</span> <span class="o">=</span> <span class="n">fill_confidence_matrix</span><span class="p">(</span><span class="n">col_count</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">subs</span><span class="p">,</span> <span class="n">active</span><span class="p">,</span> <span class="n">align_mat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.0100&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.9900&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.5000&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.5000&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.3333&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conf_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="go">&#39;0.6667&#39;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.fill_consensus_position_matrix">
<span id="polya-fill-consensus-position-matrix-module"></span><h2>polyA.fill_consensus_position_matrix module<a class="headerlink" href="#module-polyA.fill_consensus_position_matrix" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.fill_consensus_position_matrix.fill_consensus_position_matrix">
<span class="sig-prename descclassname"><span class="pre">polyA.fill_consensus_position_matrix.</span></span><span class="sig-name descname"><span class="pre">fill_consensus_position_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row_count</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_count</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_all</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chroms</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stops</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_starts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strands</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#polyA.matrices.ConsensusMatrixContainer" title="polyA.matrices.ConsensusMatrixContainer"><span class="pre">polyA.matrices.ConsensusMatrixContainer</span></a><a class="headerlink" href="#polyA.fill_consensus_position_matrix.fill_consensus_position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills matrix that holds the consensus position for each subfam at that
position in the alignment. Walks along the alignments one nucleotide at a time adding
the consensus position to the matrix.</p>
<p>At same time, fills ActiveCells.</p>
<p>input:</p>
<p>column_count: number of columns in alignment matrix - will be same number of
columns in consensus_matrix
row_count: number of rows in matrices
start_all: min start position on chromosome/target sequences for whole alignment
subfams: actual subfamily/consensus sequences from alignment
chroms: actual target/chromosome sequences from alignment
starts: start positions for all competing alignments (on target)
stops: stop positions for all competing alignments (on target)
consensus_starts: where alignment starts in the subfam/consensus sequence
strands: what strand each of the alignments are on - reverse strand will count down instead of up</p>
<p>output:</p>
<p>ConsensusMatrixContainer</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;.AA&quot;</span><span class="p">,</span> <span class="s2">&quot;TT-&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chrs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;.AA&quot;</span><span class="p">,</span> <span class="s2">&quot;TTT&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con_strts</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strandss</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">active</span><span class="p">,</span> <span class="n">con_mat</span> <span class="o">=</span> <span class="n">fill_consensus_position_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">subs</span><span class="p">,</span> <span class="n">chrs</span><span class="p">,</span> <span class="n">strts</span><span class="p">,</span> <span class="n">stps</span><span class="p">,</span> <span class="n">con_strts</span><span class="p">,</span> <span class="n">strandss</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con_mat</span>
<span class="go">{(1, 2): 0, (1, 3): 1, (2, 1): 10, (2, 2): 9, (2, 3): 9, (0, 0): 0, (0, 1): 0, (0, 2): 0}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">active</span>
<span class="go">{2: [0, 1, 2], 3: [0, 1, 2], 1: [0, 2], 0: [0]}</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.fill_node_confidence">
<span id="polya-fill-node-confidence-module"></span><h2>polyA.fill_node_confidence module<a class="headerlink" href="#module-polyA.fill_node_confidence" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.fill_node_confidence.fill_node_confidence">
<span class="sig-prename descclassname"><span class="pre">polyA.fill_node_confidence.</span></span><span class="sig-name descname"><span class="pre">fill_node_confidence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_all</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_inits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_exts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stops</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">changes_position</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfam_seqs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_seqs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfam_countss</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_matrices</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#polyA.substitution_matrix.SubMatrix" title="polyA.substitution_matrix.SubMatrix"><span class="pre">polyA.substitution_matrix.SubMatrix</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat_scores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr_count</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.fill_node_confidence.fill_node_confidence" title="Permalink to this definition">¶</a></dt>
<dd><p>for a particular annotated node, takes all competing alignments and calculates
the confidence for that node</p>
<p>first fills matrix with node alignment scores, then reuses matrix for confidence scores
Using changes_position indentifies boundaries for all nodes, and computes confidence
values for each node.</p>
<p>input:
all input needed for CalcScore() and ConfidenceCM()
nodes: number of nodes
changes_pos: node boundaries
columns: all non empty columns in matrices</p>
<p>output:
node_confidence: Hash implementation of sparse 2D matrix that holds confidence values
for whole nodes. Used during stitching process. Tuple[str, int] is key that maps a subfamily
and node number to a confidence score.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">non_cols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span> <span class="s2">&quot;n1&quot;</span><span class="p">,</span> <span class="s2">&quot;n2&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_seqs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;AAA-TTTT-T&#39;</span><span class="p">,</span> <span class="s1">&#39;TTTTTTTTTT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_seqs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;TTTTTTTTTT&#39;</span><span class="p">,</span> <span class="s1">&#39;TTTTTTTTTT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;skip&quot;</span><span class="p">:</span> <span class="mf">.33</span><span class="p">,</span> <span class="s2">&quot;n1&quot;</span><span class="p">:</span> <span class="mf">.33</span><span class="p">,</span> <span class="s2">&quot;n2&quot;</span><span class="p">:</span> <span class="mf">.33</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_mat</span> <span class="o">=</span> <span class="n">SubMatrix</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mf">0.1227</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_mat</span><span class="o">.</span><span class="n">scores</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;AA&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;TA&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;TT&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_mat</span><span class="o">.</span><span class="n">background_freqs</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_mats</span> <span class="o">=</span> <span class="p">[</span><span class="n">sub_mat</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rep_scores</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_conf</span> <span class="o">=</span> <span class="n">fill_node_confidence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">non_cols</span><span class="p">,</span> <span class="n">strts</span><span class="p">,</span> <span class="n">stps</span><span class="p">,</span> <span class="n">change_pos</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">s_seqs</span><span class="p">,</span> <span class="n">c_seqs</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">sub_mats</span><span class="p">,</span> <span class="n">rep_scores</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_conf</span>
<span class="go">{(&#39;n1&#39;, 0): 0.19999999999999998, (&#39;n2&#39;, 0): 0.7999999999999999, (&#39;n1&#39;, 1): 0.058823529411764705, (&#39;n2&#39;, 1): 0.9411764705882353, (&#39;n1&#39;, 2): 0.1111111111111111, (&#39;n2&#39;, 2): 0.8888888888888888}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_seqs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;AAA-T--TT-&#39;</span><span class="p">,</span> <span class="s1">&#39;TTTTTTTTTT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_seqs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;TTTTTTTTTT&#39;</span><span class="p">,</span> <span class="s1">&#39;TTTTTTTTTT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_conf2</span> <span class="o">=</span> <span class="n">fill_node_confidence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">non_cols</span><span class="p">,</span> <span class="n">strts</span><span class="p">,</span> <span class="n">stps</span><span class="p">,</span> <span class="n">change_pos</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">s_seqs</span><span class="p">,</span> <span class="n">c_seqs</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">sub_mats</span><span class="p">,</span> <span class="n">rep_scores</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_conf2</span>
<span class="go">{(&#39;n1&#39;, 0): 0.19999999999999998, (&#39;n2&#39;, 0): 0.7999999999999999, (&#39;n1&#39;, 1): 0.001949317738791423, (&#39;n2&#39;, 1): 0.9980506822612085, (&#39;n1&#39;, 2): 0.1111111111111111, (&#39;n2&#39;, 2): 0.8888888888888888}</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.fill_path_graph">
<span id="polya-fill-path-graph-module"></span><h2>polyA.fill_path_graph module<a class="headerlink" href="#module-polyA.fill_path_graph" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.fill_path_graph.fill_path_graph">
<span class="sig-prename descclassname"><span class="pre">polyA.fill_path_graph.</span></span><span class="sig-name descname"><span class="pre">fill_path_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">changes_position</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_matrix_collapse</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand_matrix_collapse</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_confidence</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams_collapse_index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.fill_path_graph.fill_path_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>finds alternative paths through the nodes - used for stitching to find nested elements
and to stitch back together elements that have been inserted into.</p>
<p>Alternative edges only added when on same strand, and confidence of other node label is above a certain
threshold and when the alignments are relatively contiguous in the consensus sequence.</p>
<p>input:
nodes: number of nodes
columns: list with all non empty columns in matrices
changes: list of node boundaries
changes_position: list of subfams identified for each node
consensus_matrix_collapse: matrix holding alignment position in consensus/subfam seqs -
used to identify whether nodes are spacially close enough for an alternative edge
strand_matrix_collapse: matrix holding strand for alignments
node_confidence: competing annoation confidence for nodes
subfams_collapse_index: maps subfam names to their row indices in collapsed matrices</p>
<p>output:
path_graph: Flat array reprepsentation of 2D matrix. Graph used during stitching. Maps nodes to all other nodes.
1 if nodes are connected, 0 if not</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">non_cols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">changess</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">,</span> <span class="s2">&quot;s1&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">changes_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con_mat_col</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span> <span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span> <span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span> <span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span> <span class="mi">9</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strand_mat_col</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span> <span class="s1">&#39;-&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_conf</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">0.9</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.9</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_col_ind</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;s1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;s2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill_path_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">non_cols</span><span class="p">,</span> <span class="n">changess</span><span class="p">,</span> <span class="n">changes_pos</span><span class="p">,</span> <span class="n">con_mat_col</span><span class="p">,</span> <span class="n">strand_mat_col</span><span class="p">,</span> <span class="n">node_conf</span><span class="p">,</span> <span class="n">sub_col_ind</span><span class="p">)</span>
<span class="go">[0, 1, 1, 0, 0, 1, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.fill_probability_matrix">
<span id="polya-fill-probability-matrix-module"></span><h2>polyA.fill_probability_matrix module<a class="headerlink" href="#module-polyA.fill_probability_matrix" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.fill_probability_matrix.fill_probability_matrix">
<span class="sig-prename descclassname"><span class="pre">polyA.fill_probability_matrix.</span></span><span class="sig-name descname"><span class="pre">fill_probability_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">same_prob_skip</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_prob</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_prob</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_prob_skip</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapsed_matrices</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#polyA.matrices.CollapsedMatrices" title="polyA.matrices.CollapsedMatrices"><span class="pre">polyA.matrices.CollapsedMatrices</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.fill_probability_matrix.fill_probability_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the probability score matrix to find most probable path through
the support matrix. Fills the origin matrix for easier backtrace.</p>
<p>The basic algorithm is described below.</p>
<ol class="arabic simple">
<li><p>Look at all i’s in j-1</p></li>
<li><p>Multiply by confidence in current cell</p></li>
<li><p>If it comes from same i, multiply by the higher probability</p></li>
<li><p>Else multiply by the lower probability divided by (numseqs-1) so sum of
all probs == 1</p></li>
<li><p>Return max</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All probabilities are in log space.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>same_prob_skip</strong> – penalty given to staying in the skip state</p></li>
<li><p><strong>same_prob</strong> – penalty given to staying in the same row</p></li>
<li><p><strong>change_prob</strong> – penalty given for changing rows</p></li>
<li><p><strong>change_prob_skip</strong> – penalty given for changing rows in or out of skip state</p></li>
<li><p><strong>columns</strong> – list that holds all non empty columns in matrices
CollapsedMatrices container</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">col_list</span></code>: last column of prob matrix, needed to find max to know where
to start the backtrace.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">origin_matrix</span></code>: Hash implementation of sparse 2D DP matrix. This is a
collapsed matrix. Holds which cell in previous column the probability in
the DP matrix came from. Used when doing backtrace through the DP
matrix.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">same_subfam_change_matrix</span></code>: parallel to origin_matrix, if 1 - came from
same subfam, but got a change probability. When doing backtrace, have to
note this is same subfam name, but different annotation.</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Add a larger test for this function</p>
</div>
</dd></dl>

</section>
<section id="module-polyA.fill_support_matrix">
<span id="polya-fill-support-matrix-module"></span><h2>polyA.fill_support_matrix module<a class="headerlink" href="#module-polyA.fill_support_matrix" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.fill_support_matrix.fill_support_matrix">
<span class="sig-prename descclassname"><span class="pre">polyA.fill_support_matrix.</span></span><span class="sig-name descname"><span class="pre">fill_support_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stops</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.fill_support_matrix.fill_support_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the support_matrix using values in <cite>confidence_matrix</cite>. Average
confidence values for surrounding <cite>chunk_size</cite> confidence values -
normalized by dividing by number of segments.</p>
<p>The score for subfam x at position i is the sum of all confidences for
subfam x for all segments that overlap position i - divided by the number of
segments.</p>
<p>TODO: Verify that this function works when TRs are present in the matrix
If TRs are condensed into a single row before this function is called then
there might be gaps, which will cause errors here since we assume no gaps in
a given row. If we need to deal with gaps we could do so by catching key
errors and treating them as “end markers” for a given section of data in the
condensed row.</p>
<p>Inputs:</p>
<p>chunk_size - the width of the window to use when averaging confidence
scores. This is assumed to be an odd number &gt;= 3.</p>
<p>starts - a list of start columns for each row in the confidence matrix.
These positions come should come directly from the alignments without any
offsetting. The exception is the first value, which should contain the
minimum of the remaining values, less one, in other words, <cite>starts[0] ==
min(starts[1:]) - 1</cite>. This is the implicit start position for the skip
state, which occupies the first row and is the only row that has data in the
first column of the confidence matrix.</p>
<p>stops - equivalent to the starts list, but contains the last column in each
row that contains data. Again, the first value is special and should contain
the maximum of the remaining values. In other words, <cite>stops[0] ==
max(stops[1:]) + 1</cite>.</p>
<p>confidence_matrix - confidence values computed with fill_confidence_matrix.
The confidence matrix should have one contiguous run of values per row.</p>
<p>Outputs:</p>
<p>support_matrix - support values represent average confidence values over a
window chunk_size wide at each position in the confidence matrix. This is
the “support score”.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf_mat</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">0.9</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.3</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">supp_mat</span> <span class="o">=</span> <span class="n">fill_support_matrix</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">chunk_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">starts</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">stops</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">confidence_matrix</span><span class="o">=</span><span class="n">conf_mat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">conf_mat</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.6333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">in</span> <span class="n">supp_mat</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">in</span> <span class="n">supp_mat</span>
<span class="go">False</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf_mat</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">0.9</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.9</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="mf">0.9</span><span class="p">,</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">supp_mat</span> <span class="o">=</span> <span class="n">fill_support_matrix</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">chunk_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">starts</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">stops</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">confidence_matrix</span><span class="o">=</span><span class="n">conf_mat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">conf_mat</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">0.9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.7667</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.6333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.3667</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.2333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">in</span> <span class="n">supp_mat</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.6333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.7667</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">supp_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">in</span> <span class="n">supp_mat</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.get_path">
<span id="polya-get-path-module"></span><h2>polyA.get_path module<a class="headerlink" href="#module-polyA.get_path" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.get_path.get_path">
<span class="sig-prename descclassname"><span class="pre">polyA.get_path.</span></span><span class="sig-name descname"><span class="pre">get_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams_collapse</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_column</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_cells_collapse</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_subfam_change_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.get_path.get_path" title="Permalink to this definition">¶</a></dt>
<dd><p>back traces through origin matrix to get most probable path through the DP matrix.
Finds where the path switches to a different row and populates Changes and ChangesPosition.
Reverses Changes and ChangesPosition because it’s a backtrace so they are initially backwards.
Jumps over removed/empty columns when necessary.</p>
<p>assigns IDs to each col in matrices (corresponds to a nucleotide position in target/chrom
sequence) - cols with same ID are part of same initial subfam</p>
<p>input:
temp_id: current id number being used - makes it so new ids are unique
columns: list of non empty columns in matrices
ids: list of ids for each column in matrices
changes_orig: original changes from first DP trace
changes_pos_orig: original changes_position from first DP trace
columns_orig: original list of non empty columns before any nodes are extracted
subfams_collapse: subfamily names for the rows
last_column: last column in probability matrix. Used to find where to start backtrace.
active_cells_collapse: holds which rows haves values for each column
origin_matrix: origin matrix
same_subfam_change_matrix: parallel to origin_matrix, if 1 - came from the same subfam, but
got a change transition probability</p>
<p>output:
temp_id: updated current id number being used after function completes
changes_position: which columns (positions in target/chrom seq) switch to different subfam
changes: parallel array to changes_position - what subfam is being switches to
updates input list ids</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">non_cols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idss</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">active_col</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">last_col</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orig_mat</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">same_sub_mat</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">changes_pos</span><span class="p">,</span> <span class="n">changess</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_path</span><span class="p">(</span><span class="n">non_cols</span><span class="p">,</span> <span class="n">idss</span><span class="p">,</span> <span class="n">subs</span><span class="p">,</span> <span class="n">last_col</span><span class="p">,</span> <span class="n">active_col</span><span class="p">,</span> <span class="n">orig_mat</span><span class="p">,</span> <span class="n">same_sub_mat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">changes_pos</span>
<span class="go">[0, 2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">changess</span>
<span class="go">[&#39;s1&#39;, &#39;s2&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idss</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">idss</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idss</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">idss</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idss</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">idss</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.lambda_provider">
<span id="polya-lambda-provider-module"></span><h2>polyA.lambda_provider module<a class="headerlink" href="#module-polyA.lambda_provider" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="polyA.lambda_provider.ConstantLambdaProvider">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.lambda_provider.</span></span><span class="sig-name descname"><span class="pre">ConstantLambdaProvider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.lambda_provider.ConstantLambdaProvider" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A test double that returns a fixed value regardless of the
value passed when called.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">:</span> <span class="n">LambdaProvider</span> <span class="o">=</span> <span class="n">ConstantLambdaProvider</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">({})</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="polyA.lambda_provider.EaselLambdaProvider">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.lambda_provider.</span></span><span class="sig-name descname"><span class="pre">EaselLambdaProvider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">easel_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.lambda_provider.EaselLambdaProvider" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A provider that executes Easel behind the scenes to recover a
lambda value for the given matrix.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polyA.lambda_provider.LambdaProvider">
<span class="sig-prename descclassname"><span class="pre">polyA.lambda_provider.</span></span><span class="sig-name descname"><span class="pre">LambdaProvider</span></span><a class="headerlink" href="#polyA.lambda_provider.LambdaProvider" title="Permalink to this definition">¶</a></dt>
<dd><p>A callback that accepts a substitution matrix name
and returns the corresponding lambda value for that
matrix.</p>
<p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd></dl>

</section>
<section id="module-polyA.load_alignments">
<span id="polya-load-alignments-module"></span><h2>polyA.load_alignments module<a class="headerlink" href="#module-polyA.load_alignments" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="polyA.load_alignments.Shard">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.load_alignments.</span></span><span class="sig-name descname"><span class="pre">Shard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alignments</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.load_alignments.Shard" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.load_alignments.Shard.alignments">
<span class="sig-name descname"><span class="pre">alignments</span></span><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#polyA.alignment.Alignment" title="polyA.alignment.Alignment"><span class="pre">polyA.alignment.Alignment</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.load_alignments.Shard.alignments" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.load_alignments.Shard.start">
<span class="sig-name descname"><span class="pre">start</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.load_alignments.Shard.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.load_alignments.Shard.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.load_alignments.Shard.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.load_alignments.load_alignment_tool">
<span class="sig-prename descclassname"><span class="pre">polyA.load_alignments.</span></span><span class="sig-name descname"><span class="pre">load_alignment_tool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">TextIO</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">str</span><a class="headerlink" href="#polyA.load_alignments.load_alignment_tool" title="Permalink to this definition">¶</a></dt>
<dd><p>Return alignment tool used.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.load_alignments.load_alignments">
<span class="sig-prename descclassname"><span class="pre">polyA.load_alignments.</span></span><span class="sig-name descname"><span class="pre">load_alignments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">TextIO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_skip_state</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#polyA.alignment.Alignment" title="polyA.alignment.Alignment"><span class="pre">polyA.alignment.Alignment</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.load_alignments.load_alignments" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a set of alignments in Stockholm format.
See below for an example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#=GF ID  MERX#DNA/TcMar-Tigger</span>
<span class="c1">#=GF TR  chr0:0000-0000</span>
<span class="c1">#=GF SC  1153</span>
<span class="c1">#=GF ST  +</span>
<span class="c1">#=GF TQ  -1</span>
<span class="c1">#=GF ST  127</span>
<span class="c1">#=GF SP  601</span>
<span class="c1">#=GF CST 135</span>
<span class="c1">#=GF CSP 628</span>
<span class="c1">#=GF FL  128</span>
<span class="c1">#=GF MX  20p41g.matrix</span>
<span class="c1">#=GF GI -25</span>
<span class="c1">#=GF GE -5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.load_alignments.shard_overlapping_alignments">
<span class="sig-prename descclassname"><span class="pre">polyA.load_alignments.</span></span><span class="sig-name descname"><span class="pre">shard_overlapping_alignments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alignments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#polyA.alignment.Alignment" title="polyA.alignment.Alignment"><span class="pre">polyA.alignment.Alignment</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_gap</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_skip_state</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#polyA.load_alignments.Shard" title="polyA.load_alignments.Shard"><span class="pre">polyA.load_alignments.Shard</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.load_alignments.shard_overlapping_alignments" title="Permalink to this definition">¶</a></dt>
<dd><p>Shard the given alignments into overlapping groups, separated by no more
than <cite>shard_gap</cite> nucleotides. This allows for more efficient processing
for alignments over large regions of sequence (such as an entire genome)
where many regions will be empty.
Precondition: alignments are sorted by their start position and all
alignments have start position &lt;= stop position.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">skip</span> <span class="o">=</span> <span class="n">get_skip_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a0</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[],</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[],</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shards</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">shard_overlapping_alignments</span><span class="p">([</span><span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">],</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">shards</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shards</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shards</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span>
<span class="go">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">shards</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shards</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
<span class="go">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shards</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span>
<span class="go">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">shards</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.matrices">
<span id="polya-matrices-module"></span><h2>polyA.matrices module<a class="headerlink" href="#module-polyA.matrices" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="polyA.matrices.CollapsedMatrices">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.matrices.</span></span><span class="sig-name descname"><span class="pre">CollapsedMatrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row_num_update</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">support_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfamilies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfamily_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfam_alignments_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.matrices.CollapsedMatrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.CollapsedMatrices.active_rows">
<span class="sig-name descname"><span class="pre">active_rows</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.matrices.CollapsedMatrices.active_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.CollapsedMatrices.consensus_matrix">
<span class="sig-name descname"><span class="pre">consensus_matrix</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.matrices.CollapsedMatrices.consensus_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.CollapsedMatrices.row_num_update">
<span class="sig-name descname"><span class="pre">row_num_update</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.matrices.CollapsedMatrices.row_num_update" title="Permalink to this definition">¶</a></dt>
<dd><p>all matrices used in DP are “collapsed” meaning if there are duplicate rows with the same
subfamily they are collapsed into the same row. We choose which original row to use in the
collapsed version by doing a mini DP to find the most probable.</p>
<p>updates number of rows in matrices</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.CollapsedMatrices.strand_matrix">
<span class="sig-name descname"><span class="pre">strand_matrix</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.matrices.CollapsedMatrices.strand_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.CollapsedMatrices.subfam_alignments_matrix">
<span class="sig-name descname"><span class="pre">subfam_alignments_matrix</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.matrices.CollapsedMatrices.subfam_alignments_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.CollapsedMatrices.subfamilies">
<span class="sig-name descname"><span class="pre">subfamilies</span></span><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.matrices.CollapsedMatrices.subfamilies" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.CollapsedMatrices.subfamily_indices">
<span class="sig-name descname"><span class="pre">subfamily_indices</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.matrices.CollapsedMatrices.subfamily_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.CollapsedMatrices.support_matrix">
<span class="sig-name descname"><span class="pre">support_matrix</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.matrices.CollapsedMatrices.support_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="polyA.matrices.ConsensusMatrixContainer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.matrices.</span></span><span class="sig-name descname"><span class="pre">ConsensusMatrixContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">active_rows</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.matrices.ConsensusMatrixContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>A container for a consensus matrix along with its context.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.ConsensusMatrixContainer.active_rows">
<span class="sig-name descname"><span class="pre">active_rows</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.matrices.ConsensusMatrixContainer.active_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Mapping from column index to a list of row
indices in that column that are “active” (have data in them).
This lets us avoid looping through unnecessary rows.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.matrices.ConsensusMatrixContainer.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.matrices.ConsensusMatrixContainer.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Hash implementation of a sparse 2D matrix used along with DP
matrices. The key is a 2-tuple of row and column indices
(respectively) and the values are the alignment positions in the
consensus subfamily sequence.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-polyA.output">
<span id="polya-output-module"></span><h2>polyA.output module<a class="headerlink" href="#module-polyA.output" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="polyA.output.Output">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.output.</span></span><span class="sig-name descname"><span class="pre">Output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.output.Output" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to manage creating output file objects.</p>
<p>TODO(George): Use this for the log file</p>
<dl class="py method">
<dt class="sig sig-object py" id="polyA.output.Output.get_heatmap">
<span class="sig-name descname"><span class="pre">get_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">TextIO</span><a class="headerlink" href="#polyA.output.Output.get_heatmap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyA.output.Output.get_results">
<span class="sig-name descname"><span class="pre">get_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">TextIO</span><a class="headerlink" href="#polyA.output.Output.get_results" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyA.output.Output.get_soda">
<span class="sig-name descname"><span class="pre">get_soda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">TextIO</span><span class="p"><span class="pre">,</span> </span><span class="pre">TextIO</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.output.Output.get_soda" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-polyA.pad_sequences">
<span id="polya-pad-sequences-module"></span><h2>polyA.pad_sequences module<a class="headerlink" href="#module-polyA.pad_sequences" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.pad_sequences.pad_sequences">
<span class="sig-prename descclassname"><span class="pre">polyA.pad_sequences.</span></span><span class="sig-name descname"><span class="pre">pad_sequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfam_seqs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_seqs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_char</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#polyA.pad_sequences.pad_sequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Right-pad sequences with <cite>(chunk_size - 1) / 2</cite> copies of “.”.</p>
<p>The first sequence is ignored since that is the skip state.</p>
<p>The <cite>padding_char</cite> parameter exists because the doctest doesn’t “see” the
periods, so the test will pass no matter how many are added to each
sequence.</p>
<p>Inputs:</p>
<p>chunk_size: size (in nucleotides) of each segment
subfam_seqs: actual subfamily / consensus sequences from alignment
chrom_seqs: actual target / chromosome sequences from alignment
padding_char: for testing, specifies the character to use for padding</p>
<p>Side effects:</p>
<p>Updates subfam_seqs and chrom_seqs with padded sequences</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s_seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;aaa&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;t-t&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pad_sequences</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="n">s_seq</span><span class="p">,</span> <span class="n">c_seq</span><span class="p">,</span> <span class="n">padding_char</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_seq</span>
<span class="go">[&#39;&#39;, &#39;a----------------&#39;, &#39;aaa----------------&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_seq</span>
<span class="go">[&#39;&#39;, &#39;a----------------&#39;, &#39;t-t----------------&#39;]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.performance">
<span id="polya-performance-module"></span><h2>polyA.performance module<a class="headerlink" href="#module-polyA.performance" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.performance.reset_timeit_file">
<span class="sig-prename descclassname"><span class="pre">polyA.performance.</span></span><span class="sig-name descname"><span class="pre">reset_timeit_file</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#polyA.performance.reset_timeit_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.performance.reset_timeit_logger">
<span class="sig-prename descclassname"><span class="pre">polyA.performance.</span></span><span class="sig-name descname"><span class="pre">reset_timeit_logger</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#polyA.performance.reset_timeit_logger" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.performance.set_timeit_file">
<span class="sig-prename descclassname"><span class="pre">polyA.performance.</span></span><span class="sig-name descname"><span class="pre">set_timeit_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">TextIO</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.performance.set_timeit_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.performance.set_timeit_logger">
<span class="sig-prename descclassname"><span class="pre">polyA.performance.</span></span><span class="sig-name descname"><span class="pre">set_timeit_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">logging.Logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.performance.set_timeit_logger" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.performance.timeit">
<span class="sig-prename descclassname"><span class="pre">polyA.performance.</span></span><span class="sig-name descname"><span class="pre">timeit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.performance.timeit" title="Permalink to this definition">¶</a></dt>
<dd><p>A benchmarking helper intended for us as a decorator. To use, decorate a
function with <cite>&#64;timeit()</cite>, then set the <cite>POLYA_PERFORMANCE</cite> environment
variable to any value when the program is run.</p>
<p>Output will be written to stderr unless a <cite>file</cite> is provided by calling
<cite>set_timeit_file</cite>, in which case that will be used. If a logger is passed to
<cite>set_timeit_logger</cite> then that will be used for output preferentially.</p>
<p>TODO: Allow time units to be specified at decoration site</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">io</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">ENV_VAR_NAME</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_timeit_file</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">perf_sum</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">()(</span><span class="nb">sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">perf_sum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stream</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()[:</span><span class="mi">31</span><span class="p">]</span>
<span class="go">&#39;[PERFORMANCE] time spent in sum&#39;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-polyA.print_helpers">
<span id="polya-print-helpers-module"></span><h2>polyA.print_helpers module<a class="headerlink" href="#module-polyA.print_helpers" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.print_helpers.find_consensus_lengths">
<span class="sig-prename descclassname"><span class="pre">polyA.print_helpers.</span></span><span class="sig-name descname"><span class="pre">find_consensus_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alignments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#polyA.alignment.Alignment" title="polyA.alignment.Alignment"><span class="pre">polyA.alignment.Alignment</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.print_helpers.find_consensus_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Consensus sequence lengths used by the SODA printer.</p>
</dd></dl>

</section>
<section id="module-polyA.printers">
<span id="polya-printers-module"></span><h2>polyA.printers module<a class="headerlink" href="#module-polyA.printers" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="polyA.printers.Printer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.printers.</span></span><span class="sig-name descname"><span class="pre">Printer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">TextIO</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soda_conf_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">TextIO</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soda_viz_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">TextIO</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_matrix_position</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sequence_position</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.printers.Printer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="polyA.printers.Printer.print_results_chrom">
<span class="sig-name descname"><span class="pre">print_results_chrom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_all</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr_changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#polyA.printers.Printer.print_results_chrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Print final results. Start and stop are in terms of the chromosome /
target position.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyA.printers.Printer.print_results_header">
<span class="sig-name descname"><span class="pre">print_results_header</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#polyA.printers.Printer.print_results_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyA.printers.Printer.print_results_matrix">
<span class="sig-name descname"><span class="pre">print_results_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr_changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#polyA.printers.Printer.print_results_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Print final results. Start and stop are in terms of matrix position.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyA.printers.Printer.print_results_sequence">
<span class="sig-name descname"><span class="pre">print_results_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_all</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr_changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#polyA.printers.Printer.print_results_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Print final results. Start and stop are in terms of the target sequence.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyA.printers.Printer.print_results_simple">
<span class="sig-name descname"><span class="pre">print_results_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#polyA.printers.Printer.print_results_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>A version of the output printer that takes the exact values to output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyA.printers.Printer.print_results_soda">
<span class="sig-name descname"><span class="pre">print_results_soda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_all</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_end</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">changes_orig</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr_consensus_changes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">changes_position_orig</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns_orig</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_lengths</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand_matrix_collapse</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_matrix_collapse</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams_collapse_index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_confidence_orig</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfam_alignments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_alignments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alignments_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subfams_collapse</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_col</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#polyA.printers.Printer.print_results_soda" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the results in the proper format to input into the SODA visualization
tool.</p>
<p>The output format is described here:
<a class="reference external" href="https://genome.ucsc.edu/cgi-bin/hgTables?db=hg38&amp;hgta_group=rep&amp;hgta_track=joinedRmsk&amp;hgta_table=rmskJoinedCurrent&amp;hgta_doSchema=describe+table+schema">https://genome.ucsc.edu/cgi-bin/hgTables?db=hg38&amp;hgta_group=rep&amp;hgta_track=joinedRmsk&amp;hgta_table=rmskJoinedCurrent&amp;hgta_doSchema=describe+table+schema</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyA.printers.Printer.set_soda_files">
<span class="sig-name descname"><span class="pre">set_soda_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">viz_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">TextIO</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">TextIO</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.printers.Printer.set_soda_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the output files to be used when producing SODA output. Setting a
file to <cite>None</cite> will close the existing file first.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyA.printers.Printer.use_matrix_position">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">use_matrix_position</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#polyA.printers.Printer.use_matrix_position" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyA.printers.Printer.use_sequence_position">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">use_sequence_position</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#polyA.printers.Printer.use_sequence_position" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyA.printers.Printer.use_soda_output">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">use_soda_output</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#polyA.printers.Printer.use_soda_output" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-polyA.prior_counts">
<span id="polya-prior-counts-module"></span><h2>polyA.prior_counts module<a class="headerlink" href="#module-polyA.prior_counts" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.prior_counts.read_prior_counts">
<span class="sig-prename descclassname"><span class="pre">polyA.prior_counts.</span></span><span class="sig-name descname"><span class="pre">read_prior_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior_counts_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">TextIO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_trs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.prior_counts.read_prior_counts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-polyA.substitution_matrix">
<span id="polya-substitution-matrix-module"></span><h2>polyA.substitution_matrix module<a class="headerlink" href="#module-polyA.substitution_matrix" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="polyA.substitution_matrix.ParseError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.substitution_matrix.</span></span><span class="sig-name descname"><span class="pre">ParseError</span></span><a class="headerlink" href="#polyA.substitution_matrix.ParseError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="polyA.substitution_matrix.SubMatrix">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.substitution_matrix.</span></span><span class="sig-name descname"><span class="pre">SubMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.substitution_matrix.SubMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A single substitution matrix, including its name, lambda value, and assumed
character background frequencies.
The lambda value may be <cite>None</cite>, in which case it must be computed
before the matrix can be used.
The background frequencies may also be ‘None’ if complexity adjusted scoring
will not be used.</p>
<p>A single matrix maps ‘&lt;char1&gt;&lt;char2&gt;’ (a pair of characters from
the input alphabet) to the score from the input substitution
matrix.</p>
<p>For example: ‘AA’ =&gt; 8</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.substitution_matrix.SubMatrix.background_freqs">
<span class="sig-name descname"><span class="pre">background_freqs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.substitution_matrix.SubMatrix.background_freqs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.substitution_matrix.SubMatrix.lamb">
<span class="sig-name descname"><span class="pre">lamb</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><a class="headerlink" href="#polyA.substitution_matrix.SubMatrix.lamb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.substitution_matrix.SubMatrix.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#polyA.substitution_matrix.SubMatrix.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.substitution_matrix.SubMatrix.scores">
<span class="sig-name descname"><span class="pre">scores</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.substitution_matrix.SubMatrix.scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyA.substitution_matrix.load_substitution_matrices">
<span class="sig-prename descclassname"><span class="pre">polyA.substitution_matrix.</span></span><span class="sig-name descname"><span class="pre">load_substitution_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">TextIO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_provider</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complexity_adjustment</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphabet_chars</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'AGCTYRWSKMDVHBXN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambiguity_chars</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#polyA.substitution_matrix.SubMatrix" title="polyA.substitution_matrix.SubMatrix"><span class="pre">polyA.substitution_matrix.SubMatrix</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#polyA.substitution_matrix.load_substitution_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a set of score matrices from a file and returns a
<cite>SubMatrixCollection</cite> that contains the matrices and any lambda
values associated with them.</p>
<p>Each matrix has a name, which is then specified for each
alignment that is to be adjudicated.</p>
<p>TODO: Write a doctest for this
TODO: Add additional ambiguity codes to default value</p>
</dd></dl>

</section>
<section id="module-polyA.sum_repeat_scores">
<span id="polya-sum-repeat-scores-module"></span><h2>polyA.sum_repeat_scores module<a class="headerlink" href="#module-polyA.sum_repeat_scores" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="polyA.sum_repeat_scores.sub_repeat_scores">
<span class="sig-prename descclassname"><span class="pre">polyA.sum_repeat_scores.</span></span><span class="sig-name descname"><span class="pre">sub_repeat_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat_scores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="headerlink" href="#polyA.sum_repeat_scores.sub_repeat_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Sums tandem repeat scores from columns start to end.</p>
<p>input:
start: column index to start sum
end: column index to end sum
repeat_scores: hash implementation of 1d array that maps column index
to tandem repeat score</p>
<p>output:
summ: sum of the tandem repeat scores</p>
</dd></dl>

</section>
<section id="module-polyA.ultra_provider">
<span id="polya-ultra-provider-module"></span><h2>polyA.ultra_provider module<a class="headerlink" href="#module-polyA.ultra_provider" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="polyA.ultra_provider.ApplicationUltraProvider">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.ultra_provider.</span></span><span class="sig-name descname"><span class="pre">ApplicationUltraProvider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ultra_output_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ultra_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ultra'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.ultra_provider.ApplicationUltraProvider" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="polyA.ultra_provider.TandemRepeat">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.ultra_provider.</span></span><span class="sig-name descname"><span class="pre">TandemRepeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consensus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_scores</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.ultra_provider.TandemRepeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.ultra_provider.TandemRepeat.consensus">
<span class="sig-name descname"><span class="pre">consensus</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#polyA.ultra_provider.TandemRepeat.consensus" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyA.ultra_provider.TandemRepeat.from_json">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_map</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.ultra_provider.TandemRepeat.from_json" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.ultra_provider.TandemRepeat.length">
<span class="sig-name descname"><span class="pre">length</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.ultra_provider.TandemRepeat.length" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.ultra_provider.TandemRepeat.position_scores">
<span class="sig-name descname"><span class="pre">position_scores</span></span><em class="property"><span class="pre">:</span> <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.ultra_provider.TandemRepeat.position_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.ultra_provider.TandemRepeat.start">
<span class="sig-name descname"><span class="pre">start</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.ultra_provider.TandemRepeat.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.ultra_provider.TandemRepeat.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.ultra_provider.TandemRepeat.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="polyA.ultra_provider.UltraOutput">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyA.ultra_provider.</span></span><span class="sig-name descname"><span class="pre">UltraOutput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tandem_repeats</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.ultra_provider.UltraOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="polyA.ultra_provider.UltraOutput.from_json">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_map</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyA.ultra_provider.UltraOutput.from_json" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyA.ultra_provider.UltraOutput.tandem_repeats">
<span class="sig-name descname"><span class="pre">tandem_repeats</span></span><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#polyA.ultra_provider.TandemRepeat" title="polyA.ultra_provider.TandemRepeat"><span class="pre">polyA.ultra_provider.TandemRepeat</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polyA.ultra_provider.UltraOutput.tandem_repeats" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyA.ultra_provider.UltraOutput.tr_count">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">tr_count</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#polyA.ultra_provider.UltraOutput.tr_count" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-polyA">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-polyA" title="Permalink to this headline">¶</a></h2>
<p>PolyA is a sequence annotation adjudicator.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PolyA</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">polyA</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">polyA</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">polyA</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Audrey Shingleton, Kaitlin Carey, George Lesica, Travis Wheeler.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/polyA.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>